(function(){const e="https://nostr.buzz",t={primaryColor:"#0080ff",secondaryColor:"#666",backgroundColor:"#f9f9f9",darkBackgroundColor:"#1a1a1a",defaultMethod:"lightning",defaultTheme:"dark",logo:null,containerClass:"",i18n:{title:"Support via Zap",payButton:"Send Zap",cancelButton:"Cancel",amountLabel:"Amount (sats)",methodLabel:"Payment Method",commentLabel:"Comment (optional)",successMessage:"Payment Successful!",errorMessage:"Payment Failed",loadingMessage:"Processing...",lightning:"Lightning",cashu:"Cashu",ark:"Ark"}},n=Object.assign({},t);function a(t){return`${e}/zap/${t}`}function o(e){return e.startsWith("npub1")&&e.length>=32||/^[0-9a-f]{64}$/i.test(e)}async function r(e,t={},n=3,a=1e3){try{return await fetch(e,t)}catch(o){if(n<=0)throw o;return await new Promise(e=>setTimeout(e,a)),r(e,t,n-1,1.5*a)}}function s(e,t){const n=document.createElement(e);return t&&Object.keys(t).forEach(e=>{n[e]=t[e]}),n}function i(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function l(){const e=document.getElementById("buzz-zap-modal");e&&(e.style.opacity="0",setTimeout(()=>e.remove(),300))}function c(e){const t=e?"dark":"light",a=e?n.darkBackgroundColor:n.backgroundColor;return`
    .buzz-zap-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 999999;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: rgba(0, 0, 0, 0.6);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      opacity: 0;
      transition: opacity 0.3s ease;
      backdrop-filter: blur(5px);
      -webkit-backdrop-filter: blur(5px);
    }
    .buzz-zap-modal.visible {
      opacity: 1;
    }
    .buzz-zap-content {
      width: 100%;
      max-width: 400px;
      border-radius: 12px;
      overflow: hidden;
      background-color: ${a};
      color: ${e?"#fff":"#333"};
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      position: relative;
      transform: translateY(20px);
      transition: transform 0.3s ease;
    }
    .buzz-zap-modal.visible .buzz-zap-content {
      transform: translateY(0);
    }
    .buzz-zap-header {
      background-color: ${n.primaryColor};
      padding: 15px 20px;
      color: white;
      font-weight: bold;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .buzz-zap-close {
      background: none;
      border: none;
      color: white;
      font-size: 20px;
      cursor: pointer;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background-color: rgba(255,255,255,0.2);
      transition: background-color 0.2s;
    }
    .buzz-zap-close:hover {
      background-color: rgba(255,255,255,0.3);
    }
    .buzz-zap-body {
      padding: 20px;
      position: relative;
      overflow: hidden;
    }
    .buzz-zap-field {
      margin-bottom: 16px;
    }
    .buzz-zap-label {
      display: block;
      margin-bottom: 6px;
      font-weight: 500;
      color: ${e?"#eaeaea":"#555"};
    }
    .buzz-zap-input, .buzz-zap-select, .buzz-zap-textarea {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid ${e?"#444":"#ddd"};
      background-color: ${e?"#333":"#fff"};
      color: ${e?"#fff":"#333"};
      border-radius: 6px;
      font-size: 15px;
      transition: border-color 0.2s;
    }
    .buzz-zap-input:focus, .buzz-zap-select:focus, .buzz-zap-textarea:focus {
      border-color: ${n.primaryColor};
      outline: none;
      box-shadow: 0 0 0 2px ${n.primaryColor}33;
    }
    .buzz-zap-preset {
      display: flex;
      gap: 8px;
      margin-top: 8px;
      flex-wrap: wrap;
    }
    .buzz-zap-preset button {
      border: 1px solid ${e?"#444":"#ddd"};
      background: ${e?"#333":"#f5f5f5"};
      color: ${e?"#fff":"#333"};
      border-radius: 20px;
      padding: 5px 10px;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .buzz-zap-preset button:hover {
      background: ${e?"#444":"#e5e5e5"};
    }
    .buzz-zap-preset button.active {
      background: ${n.primaryColor};
      color: white;
      border-color: ${n.primaryColor};
      transform: scale(1.05);
    }
    .buzz-zap-footer {
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      gap: 12px;
      border-top: 1px solid ${e?"#444":"#eee"};
    }
    .buzz-zap-btn {
      padding: 10px 15px;
      border-radius: 6px;
      border: none;
      font-size: 15px;
      font-weight: 500;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      flex: 1;
      transition: all 0.2s ease;
    }
    .buzz-zap-btn-primary {
      background-color: ${n.primaryColor};
      color: white;
    }
    .buzz-zap-btn-primary:hover {
      background-color: ${d(n.primaryColor,-15)};
      transform: translateY(-1px);
    }
    .buzz-zap-btn-outline {
      background-color: transparent;
      border: 1px solid ${e?"#444":"#ddd"};
      color: ${e?"#eaeaea":"#666"};
    }
    .buzz-zap-btn-outline:hover {
      background-color: ${e?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.05)"};
    }
    .buzz-zap-btn:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      transform: none;
    }
    .buzz-zap-loading, .buzz-zap-success, .buzz-zap-error {
      text-align: center;
      padding: 30px 20px;
    }
    .buzz-zap-icon {
      font-size: 48px;
      margin-bottom: 15px;
    }
    .buzz-zap-success .buzz-zap-icon {
      color: #4CAF50;
    }
    .buzz-zap-error .buzz-zap-icon {
      color: #F44336;
    }
    .buzz-zap-qr {
      text-align: center;
      margin: 20px 0;
    }
    .buzz-zap-qr img {
      max-width: 200px;
      border: 8px solid white;
      border-radius: 6px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }
    .buzz-zap-note {
      font-size: 13px;
      color: ${e?"#aaa":"#888"};
      margin-top: 15px;
      text-align: center;
    }
    .buzz-zap-amount-field {
      position: relative;
    }
    .buzz-zap-amount-field input {
      padding-left: 28px;
    }
    .buzz-zap-currency {
      position: absolute;
      left: 12px;
      top: 11px;
      font-size: 15px;
      color: ${e?"#aaa":"#888"};
    }
    .buzz-zap-logo {
      height: 24px;
      margin-right: 10px;
      object-fit: contain;
    }
    .buzz-zap-spinner {
      display: inline-block;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 3px solid rgba(255,255,255,0.3);
      border-top-color: white;
      animation: buzz-spin 1s linear infinite;
    }
    @keyframes buzz-spin {
      to { transform: rotate(360deg); }
    }
    .buzz-zap-error-notification {
      background-color: ${e?"#422":"#f8d7da"};
      color: ${e?"#f88":"#721c24"};
      padding: 8px 12px;
      border-radius: 6px;
      margin-bottom: 15px;
      font-size: 14px;
      display: flex;
      align-items: center;
    }
    .buzz-zap-error-notification svg {
      margin-right: 8px;
      flex-shrink: 0;
    }
    .buzz-zap-countdown {
      margin-top: 10px;
      font-size: 13px;
      color: ${e?"#aaa":"#888"};
    }
    @media (max-width: 480px) {
      .buzz-zap-content {
        max-width: 92%;
        margin: 0 4%;
      }
      .buzz-zap-preset {
        gap: 6px;
      }
      .buzz-zap-preset button {
        font-size: 12px;
        padding: 4px 8px;
      }
    }
    `}function d(e,t){let n=parseInt(e.substring(1,3),16),a=parseInt(e.substring(3,5),16),o=parseInt(e.substring(5,7),16);n=parseInt(n*(100+t)/100),a=parseInt(a*(100+t)/100),o=parseInt(o*(100+t)/100),n=n<255?n:255,a=a<255?a:255,o=o<255?o:255,n=n>0?n:0,a=a>0?a:0,o=o>0?o:0;const r=1===n.toString(16).length?"0"+n.toString(16):n.toString(16),s=1===a.toString(16).length?"0"+a.toString(16):a.toString(16),i=1===o.toString(16).length?"0"+o.toString(16):o.toString(16);return"#"+r+s+i}async function p(e,t){return new Promise((n,a)=>{const o=document.createElement("div");o.className="buzz-zap-body";const r=document.createElement("div");r.className="buzz-zap-qr";const s=document.createElement("img");s.src=`https://api.qrserver.com/v1/create-qr-code/?data=${encodeURIComponent(e.payment.invoice)}&size=200x200`,s.alt="Lightning QR Code",r.appendChild(s);const i=document.createElement("div");i.className="buzz-zap-field";const l=document.createElement("input");l.type="text",l.className="buzz-zap-input",l.value=e.payment.invoice,l.readOnly=!0;const c=document.createElement("button");c.className="buzz-zap-btn buzz-zap-btn-primary",c.style.marginTop="8px",c.style.width="100%",c.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg> <span style="margin-left:8px">Copy Invoice</span>',c.onclick=function(){l.select(),document.execCommand("copy"),c.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg> <span style="margin-left:8px">Copied!</span>',setTimeout(()=>{c.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg> <span style="margin-left:8px">Copy Invoice</span>'},2e3)},i.append(l,c);const d=document.createElement("div");d.className="buzz-zap-countdown",d.textContent="Waiting for payment...";const u=document.createElement("div");u.style.marginBottom="15px",u.className="buzz-zap-webln";"undefined"!=typeof window.webln&&function(){const t=document.createElement("button");t.className="buzz-zap-btn buzz-zap-btn-primary",t.style.marginTop="15px",t.style.width="100%",t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"></path></svg> <span style="margin-left:8px">Pay with WebLN</span>',t.onclick=async function(){try{await window.webln.enable();const t=await window.webln.sendPayment(e.payment.invoice);console.log("WebLN payment result:",t),n(e)}catch(e){console.error("WebLN payment error:",e);const t=document.createElement("div");t.className="buzz-zap-error-notification",t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg> Failed to pay with WebLN: '+(e.message||"Unknown error"),u.innerHTML="",u.appendChild(t)}},u.appendChild(t)}();const m=document.createElement("p");m.className="buzz-zap-note",m.innerHTML="Open your Lightning wallet, scan the QR code or paste the invoice to pay. <br>This window will update automatically when payment is detected.";const z=document.createElement("button");z.className="buzz-zap-btn buzz-zap-btn-outline",z.style.marginTop="15px",z.style.width="100%",z.textContent=n.i18n.cancelButton,z.onclick=()=>{clearInterval(h),a("Cancelled")},o.append(r,u,i,d,m,z);const b=document.querySelector(".buzz-zap-body");if(b.innerHTML="",b.appendChild(o),e.payment.expires){const t=Date.now(),n=1e3*e.payment.expires;let o=setInterval(()=>{const e=Date.now()-t,a=n-e;if(a<=0)return d.textContent="Invoice expired",clearInterval(o),void clearInterval(h);const r=Math.floor(a/6e4),s=Math.floor(a%6e4/1e3);d.textContent=`Payment expires in: ${r}:${s<10?"0":""}${s}`},1e3)}const h=setInterval(async()=>{try{const a=await r(`${t}/check/${e.payment.id}`);if(!a.ok)throw new Error(`Check response not OK: ${a.status}`);const o=await a.json();"status"in o&&"paid"===o.status&&(clearInterval(h),n(o))}catch(e){console.error("Payment check error:",e)}},2e3);setTimeout(()=>{document.contains(o)&&(clearInterval(h),a("Timeout"))},1e3*e.payment.expires||3e5)})}async function u(e){return new Promise(t=>{const n=document.createElement("div");n.className="buzz-zap-body";const a=document.createElement("p");a.textContent="Your Cashu token is ready:";const o=document.createElement("div");o.className="buzz-zap-qr";const r=document.createElement("img");r.src=`https://api.qrserver.com/v1/create-qr-code/?data=${encodeURIComponent(e.payment.token)}&size=200x200`,r.alt="Cashu Token QR Code",o.appendChild(r);const s=document.createElement("div");s.className="buzz-zap-field";const i=document.createElement("textarea");i.className="buzz-zap-textarea",i.value=e.payment.token,i.readOnly=!0,i.rows=4;const l=document.createElement("button");l.className="buzz-zap-btn buzz-zap-btn-primary",l.style.marginTop="8px",l.style.width="100%",l.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg> <span style="margin-left:8px">Copy Token</span>',l.onclick=function(){i.select(),document.execCommand("copy"),l.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg> <span style="margin-left:8px">Copied!</span>',setTimeout(()=>{l.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg> <span style="margin-left:8px">Copy Token</span>'},2e3)};const c=document.createElement("p");c.className="buzz-zap-note",c.innerHTML="Scan this QR or paste the token in your Cashu wallet.<br>This token contains the value to complete the payment.";const d=document.createElement("button");d.className="buzz-zap-btn buzz-zap-btn-primary",d.style.marginTop="15px",d.style.width="100%",d.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line></svg> <span style="margin-left:8px">Open in Cashu Wallet</span>',d.onclick=function(){try{window.location.href=`cashu:${encodeURIComponent(e.payment.token)}`,setTimeout(()=>{const e=document.createElement("p");e.className="buzz-zap-note",e.style.color="orange",e.textContent="If nothing happened, you may not have a Cashu wallet installed.",n.insertBefore(e,c.nextSibling)},1500)}catch(e){console.error("Failed to open Cashu wallet:",e)}};const p=document.createElement("div");p.className="buzz-zap-footer";const u=document.createElement("button");u.className="buzz-zap-btn buzz-zap-btn-outline",u.textContent="Close",u.onclick=()=>{t(e)};const m=document.createElement("button");m.className="buzz-zap-btn buzz-zap-btn-primary",m.textContent="Done",m.onclick=()=>{t(e)},p.append(u,m),s.append(i,l),n.append(a,o,s,d,c,p);const z=document.querySelector(".buzz-zap-body");z.innerHTML="",z.appendChild(n)})}async function m(e){return new Promise(t=>{const n=document.createElement("div");n.className="buzz-zap-success";const a=document.createElement("div");a.className="buzz-zap-icon",a.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check-circle"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>';const o=document.createElement("h3");o.textContent=c.i18n.successMessage;const r=document.createElement("p");if(r.textContent="Thank you for your support!",e.payment&&e.payment.id){const t=document.createElement("p");t.className="buzz-zap-note",t.innerHTML=`Transaction ID: <br><span style="font-family: monospace;">${e.payment.id}</span>`,n.appendChild(t)}const s=document.createElement("button");s.className="buzz-zap-btn buzz-zap-btn-primary",s.style.marginTop="20px",s.textContent="Done",s.onclick=()=>{t(e),l()},n.append(a,o,r,s);const i=document.querySelector(".buzz-zap-body");i.innerHTML="",i.appendChild(n)})}async function z(e){return new Promise(t=>{const n=document.createElement("div");n.className="buzz-zap-error";const a=document.createElement("div");a.className="buzz-zap-icon",a.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-circle"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>';const o=document.createElement("h3");o.textContent=c.i18n.errorMessage;const r=document.createElement("p");r.textContent=e.message||"An error occurred during payment processing.";const s=document.createElement("button");s.className="buzz-zap-btn buzz-zap-btn-primary",s.style.marginTop="20px",s.textContent="Close",s.onclick=()=>{t(null),l()};const i=document.createElement("button");i.className="buzz-zap-btn buzz-zap-btn-outline",i.style.marginTop="10px",i.textContent="Try Again",i.onclick=()=>{const e=new Event("retry");n.dispatchEvent(e)},n.append(a,o,r,s,i);const c=document.querySelector(".buzz-zap-body");c.innerHTML="",c.appendChild(n)})}function b(e){const t=document.createElement("div");return t.className="buzz-zap-spinner",t}function h(){const e=document.createElement("div");e.className="buzz-zap-loading";const t=b();t.className="buzz-zap-loading-spinner";const n=document.createElement("p");return n.textContent=c.i18n.loadingMessage,e.append(t,n),e}async function f(e,t){try{if(!o(e))throw new Error("Invalid public key format");const n=a(e),s=new URLSearchParams;s.append("amount",t.amount.toString()),s.append("method",t.method),t.comment&&s.append("comment",t.comment),t.event_id&&s.append("event_id",t.event_id),t.relay&&s.append("relay",t.relay);const i=await r(`${n}?${s.toString()}`);if(!i.ok)throw new Error(`API response error: ${i.status} ${i.statusText}`);const l=await i.json();if("ok"!==l.status)throw new Error(l.message||c.i18n.errorMessage);switch(l.payment.method){case"lightning":await p(l,n);break;case"cashu":await u(l);break;case"ark":case"onchain":case"paypal":default:await m(l)}return t.onSuccess(l),l}catch(e){return console.error("Payment error:",e),z(e)}}const y={open:async function(e,t={}){if(!o(e))throw new Error("Invalid Nostr public key format");const n=Object.assign({amount:1e3,method:c.defaultMethod,comment:"",theme:c.defaultTheme||"dark",title:c.i18n.title,position:"center",event_id:null,relay:null,onSuccess:()=>{},onClose:()=>{}},t);let a=n.theme==="dark";if(document.getElementById("buzz-zap-modal"))return;const r=document.createElement("div");r.id="buzz-zap-modal",r.className=`buzz-zap-modal ${c.containerClass}`.trim();const s=document.createElement("style");s.textContent=c(a);const i=document.createElement("div");i.className="buzz-zap-content",r.append(s,i);const d=()=>{l(),n.onClose()};const p=document.createDocumentFragment();const u=document.createElement("div");u.className="buzz-zap-header";const m=document.createElement("div");m.style.display="flex",m.style.alignItems="center";if(c.logo){const e=document.createElement("img");e.src=c.logo,e.className="buzz-zap-logo",e.setAttribute("alt","Logo"),m.appendChild(e)}m.appendChild(document.createTextNode(n.title));const z=document.createElement("button");z.className="buzz-zap-close",z.innerHTML="&times;",z.setAttribute("aria-label","Close"),z.onclick=d,u.append(m,z),p.appendChild(u);const b=document.createElement("div");b.className="buzz-zap-body";const f=document.createElement("div");f.className="buzz-zap-field";const y=document.createElement("label");y.className="buzz-zap-label",y.textContent=c.i18n.amountLabel,y.setAttribute("for","buzz-zap-amount");const v=document.createElement("div");v.className="buzz-zap-amount-field";const k=document.createElement("span");k.className="buzz-zap-currency",k.textContent="₿";const w=document.createElement("input");w.className="buzz-zap-input",w.id="buzz-zap-amount",w.type="number",w.value=(n.amount/1e3).toString(),w.min="1",w.step="1",w.setAttribute("aria-label","Amount in satoshis");const C=document.createElement("div");C.className="buzz-zap-preset";const E=[21,100,1e3,5e3,21e3];E.forEach(e=>{const t=document.createElement("button");t.type="button",t.textContent=e.toLocaleString(),t.className=n.amount===1e3*e?"active":"",t.setAttribute("aria-label",`Select ${e} sats`),t.onclick=function(){w.value=e.toString(),n.amount=1e3*e,E.forEach((e,n)=>{C.children[n].className=1e3*Number(w.value)===1e3*e?"active":""})},C.appendChild(t)}),v.append(k,w),f.append(y,v,C);const L=document.createElement("div");L.className="buzz-zap-field";const N=document.createElement("label");N.className="buzz-zap-label",N.textContent=c.i18n.methodLabel,N.setAttribute("for","buzz-zap-method");const x=document.createElement("select");x.className="buzz-zap-select",x.id="buzz-zap-method",x.setAttribute("aria-label","Payment method");const T={lightning:c.i18n.lightning,cashu:c.i18n.cashu,ark:c.i18n.ark};Object.entries(T).forEach(([e,t])=>{const a=document.createElement("option");a.value=e,a.textContent=t,a.selected=n.method===e,x.appendChild(a)}),L.append(N,x);const B=document.createElement("div");B.className="buzz-zap-field";const S=document.createElement("label");S.className="buzz-zap-label",S.textContent=c.i18n.commentLabel,S.setAttribute("for","buzz-zap-comment");const A=document.createElement("textarea");A.className="buzz-zap-textarea",A.id="buzz-zap-comment",A.rows=2,A.value=n.comment||"",A.setAttribute("aria-label","Comment"),A.placeholder="Optional message to include with payment",B.append(S,A),b.append(f,L,B);const P=document.createElement("div");P.className="buzz-zap-footer";const O=document.createElement("button");O.className="buzz-zap-btn buzz-zap-btn-outline",O.textContent=c.i18n.cancelButton,O.onclick=d;const j=document.createElement("button");j.className="buzz-zap-btn buzz-zap-btn-primary",j.textContent=c.i18n.payButton,P.append(O,j),p.append(u,b,P),i.appendChild(p),document.body.appendChild(r),setTimeout(()=>{r.classList.add("visible")},10),w.addEventListener("input",()=>{const e=Number(w.value);if(!isNaN(e)&&e>0){n.amount=1e3*e,E.forEach((e,t)=>{C.children[t].className=1e3*Number(w.value)===1e3*e?"active":""})}});x.addEventListener("change",()=>{n.method=x.value}),A.addEventListener("input",()=>{n.comment=A.value}),r.addEventListener("keydown",e=>{"Escape"===e.key?d():"Enter"!==e.key||"TEXTAREA"===e.target.tagName||j.click()}),j.addEventListener("click",async function(){j.disabled=!0,j.textContent="Processing...",b.innerHTML="",b.appendChild(h());try{const t=await f(e,n);t&&t.error&&console.error("Payment API error:",t.error)}catch(e){console.error("Payment processing error:",e);const t=await z(e);t&&t.addEventListener("retry",()=>{b.innerHTML="",b.appendChild(h()),f(e,n).catch(console.error)})}})},openAsync:function(e,t={}){return new Promise((n,a)=>{t.onSuccess=e=>{n(e)},t.onClose=()=>{a(new Error("Payment cancelled"))},this.open(e,t)})},config:function(e){return Object.assign(c,e),this},close:l};function v(e){"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,1):document.addEventListener("DOMContentLoaded",e)}v(()=>{window.BuzzZapModal=y})})();
